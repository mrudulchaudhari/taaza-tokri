{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Products</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>
<body>
    <!-- Location Display Bar -->
    <div class="location-bar">
        <div class="location-content">
            <span class="location-icon">üìç</span>
            <span class="location-text">Mumbai, Maharashtra</span>
            <div class="location-weather">
                <span>üå§Ô∏è</span>
                <span>28¬∞C</span>
            </div>
        </div>
    </div>

    <header class="header">
        <nav class="nav">
            <div class="logo">Foodies</div>
            <div class="nav-links">
                <a href="{% url 'listing:list_materials' %}">Home</a>
                <a href="#">Sellers</a>
                <a href="{% url 'listing:products' %}" class="active">Products</a>
                <a href="{% url 'listing:cart_detail' %}">Cart</a>
                <div class="user-profile-icon" onclick="toggleProfilePopup()">üë§</div>
            </div>
        </nav>
    </header>

    <!-- User Profile Popup -->
    <div class="popup-overlay" id="popupOverlay" onclick="closeProfilePopup()"></div>
    <div class="user-profile-popup" id="userProfilePopup">
        <div class="popup-header">
            <div class="popup-title">User Profile</div>
            <button class="close-popup" onclick="closeProfilePopup()">√ó</button>
        </div>
        <div class="popup-content">
            <div class="profile-avatar">üë§</div>
            <div class="profile-info">
                <h3>Welcome, Foodie!</h3>
                <p>Premium Buyer</p>
                <p>üìç Mumbai, Maharashtra</p>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="page-header">
            <div class="breadcrumb">Dashboard > Sellers > Products</div>
            <h1 class="page-title">Fresh Products</h1>
            <div class="vendor-info" id="vendorInfo">
                <!-- Vendor info will be populated by JavaScript -->
            </div>
        </div>

        <div class="filters-section">
            <div class="filters-grid">
                <div class="filter-group">
                    <label class="filter-label">Search Products</label>
                    <div class="search-box">
                        <span class="search-icon">üîç</span>
                        <input type="text" class="search-input" placeholder="Search products..." id="searchInput">
                    </div>
                </div>
                
                <div class="filter-group">
                    <label class="filter-label">Category</label>
                    <select class="filter-select" id="categoryFilter">
                        <option value="all">All Categories</option>
                        <option value="vegetables">Vegetables</option>
                        <option value="fruits">Fruits</option>
                        <option value="dairy">Dairy</option>
                        <option value="spices">Spices</option>
                        <option value="grains">Grains</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label class="filter-label">Sort By</label>
                    <select class="filter-select" id="sortSelect">
                        <option value="name">Name</option>
                        <option value="price-low">Price: Low to High</option>
                        <option value="price-high">Price: High to Low</option>
                        <option value="popular">Most Popular</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label class="filter-label">Price Range</label>
                    <select class="filter-select" id="priceFilter">
                        <option value="all">All Prices</option>
                        <option value="0-50">Under ‚Çπ50</option>
                        <option value="50-100">‚Çπ50 - ‚Çπ100</option>
                        <option value="100-200">‚Çπ100 - ‚Çπ200</option>
                        <option value="200+">Above ‚Çπ200</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="category-tabs" id="categoryTabs">
            <!-- Category tabs will be populated by JavaScript -->
        </div>

        <div class="results-info">
            <span id="resultsCount">Showing {{ products|length }} products</span>
            <span>Filtered by your preferences</span>
        </div>

        <div class="products-grid" id="productsGrid">
            {% for product in products %}
                <div class="product-card">
                    <div class="product-badge">{{ product.badge|default:"Fresh" }}</div>
                    <div class="product-image">{{ product.image|default:"ü•¨" }}</div>
                    <div class="product-title">{{ product.name }}</div>
                    <div class="product-description">{{ product.description }}</div>
                    <div class="product-meta">
                        <div>
                            <div class="product-price">‚Çπ{{ product.price }}</div>
                            <div class="product-unit">{{ product.unit|default:"per kg" }}</div>
                        </div>
                        <div class="product-stock">{{ product.stock|default:"In Stock" }}</div>
                    </div>
                    <div class="product-actions">
                        <div class="quantity-controls">
                            <button class="quantity-btn" onclick="updateQuantity({{ product.id }}, -1)">-</button>
                            <input type="number" class="quantity-input" value="0" min="0" 
                                   id="qty-{{ product.id }}" onchange="updateQuantity({{ product.id }}, 0)">
                            <button class="quantity-btn" onclick="updateQuantity({{ product.id }}, 1)">+</button>
                        </div>
                        <button class="btn" onclick="addToCart({{ product.id }})">Add to Cart</button>
                    </div>
                </div>
            {% empty %}
                <div class="empty-products">
                    <div class="empty-icon">üì¶</div>
                    <h3>No products available</h3>
                    <p>Check back later for fresh products!</p>
                </div>
            {% endfor %}
        </div>
    </div>

    <!-- Pass Django data to JavaScript -->
    <script>
        // Django data passed to JavaScript
        const djangoProducts = [
            {% for product in products %}
            {
                id: {{ product.id }},
                name: "{{ product.name|escapejs }}",
                description: "{{ product.description|escapejs }}",
                price: {{ product.price }},
                unit: "{{ product.unit|default:'per kg'|escapejs }}",
                category: "{{ product.category|default:'vegetables'|escapejs }}",
                stock: "{{ product.stock|default:'In Stock'|escapejs }}",
                image: "{{ product.image|default:'ü•¨'|escapejs }}",
                badge: "{{ product.badge|default:'Fresh'|escapejs }}"
            }{% if not forloop.last %},{% endif %}
            {% endfor %}
        ];
    </script>
    <script src="{% static 'js/script.js' %}"></script>
</body>
</html>