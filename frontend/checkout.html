<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Location Display Bar -->
    <div class="location-bar">
        <div class="location-content">
            <span class="location-icon">üìç</span>
            <span class="location-text">Mumbai, Maharashtra</span>
            <div class="location-weather">
                <span>üå§Ô∏è</span>
                <span>28¬∞C</span>
            </div>
        </div>
    </div>

    <header class="header">
        <nav class="nav">
            <div class="logo">Foodies</div>
            <div class="nav-links">
                <a href="buyerDashboard.html">Home</a>
                <a href="productSellers.html">Sellers</a>
                <a href="products.html">Products</a>
                <a href="cart.html">Cart</a>
                <a href="checkout.html" class="active">Checkout</a>
                <a href="login.html">Logout</a>
            </div>
        </nav>
    </header>

    <div class="container">
        <div class="page-header">
            <div class="breadcrumb">Dashboard > Cart > Checkout</div>
            <h1 class="page-title">Checkout</h1>
            <p>Complete your order with delivery and payment details</p>
        </div>

        <div class="checkout-container">
            <div class="checkout-form" id="checkoutForm">
                <div class="form-section">
                    <h3>Delivery Information</h3>
                    <div class="delivery-options">
                        <div class="delivery-option" onclick="selectDelivery('standard')">
                            <div class="delivery-icon">üöö</div>
                            <div class="delivery-details">
                                <h4>Standard Delivery</h4>
                                <p>2-4 hours delivery time</p>
                            </div>
                            <div class="delivery-price">‚Çπ50</div>
                        </div>
                        <div class="delivery-option" onclick="selectDelivery('express')">
                            <div class="delivery-icon">‚ö°</div>
                            <div class="delivery-details">
                                <h4>Express Delivery</h4>
                                <p>1-2 hours delivery time</p>
                            </div>
                            <div class="delivery-price">‚Çπ100</div>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3>Personal Information</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Full Name</label>
                            <input type="text" class="form-input" placeholder="Enter your full name" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Phone Number</label>
                            <input type="tel" class="form-input" placeholder="Enter your phone number" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Email Address</label>
                            <input type="email" class="form-input" placeholder="Enter your email address" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">City</label>
                            <select class="form-select" required>
                                <option value="">Select your city</option>
                                <option value="mumbai">Mumbai</option>
                                <option value="pune">Pune</option>
                                <option value="nagpur">Nagpur</option>
                                <option value="aurangabad">Aurangabad</option>
                            </select>
                        </div>
                        <div class="form-group full-width">
                            <label class="form-label">Delivery Address</label>
                            <textarea class="form-input" rows="3" placeholder="Enter your complete delivery address" required></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Pincode</label>
                            <input type="text" class="form-input" placeholder="Enter pincode" required>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3>Payment Method</h3>
                    <div class="payment-methods">
                        <div class="payment-method" onclick="selectPayment('cod')">
                            <div class="payment-icon">üíµ</div>
                            <div class="payment-details">
                                <h4>Cash on Delivery</h4>
                                <p>Pay when you receive your order</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3>Additional Information</h3>
                    <div class="form-group">
                        <label class="form-label">Special Instructions (Optional)</label>
                        <textarea class="form-input" rows="3" placeholder="Any special delivery instructions..."></textarea>
                    </div>
                </div>

                <div style="margin-top: var(--space-xl);">
                    <button class="btn" onclick="placeOrder()">Place Order</button>
                    <button class="btn btn-outline" onclick="goBack()" style="margin-left: var(--space-md);">Back to Cart</button>
                </div>
            </div>

            <div class="order-summary">
                <div class="summary-title">Order Summary</div>
                
                <div class="order-items" id="orderItems">
                    <!-- Order items will be populated by JavaScript -->
                </div>

                <div class="summary-row">
                    <span class="summary-label">Subtotal</span>
                    <span class="summary-value" id="subtotal">‚Çπ0</span>
                </div>
                
                <div class="summary-row">
                    <span class="summary-label">Delivery Fee</span>
                    <span class="summary-value" id="deliveryFee">‚Çπ0</span>
                </div>
                
                <div class="summary-row">
                    <span class="summary-label">Discount</span>
                    <span class="summary-value" id="discount">-‚Çπ0</span>
                </div>
                
                <div class="summary-row summary-total">
                    <span>Total</span>
                    <span id="total">‚Çπ0</span>
                </div>
            </div>
        </div>
    </div>

    <script>

        // Profile Popup Functions
        function toggleProfilePopup() {
            const popup = document.getElementById('userProfilePopup');
            const overlay = document.getElementById('popupOverlay');
            
            popup.classList.toggle('open');
            overlay.classList.toggle('open');
            
            // Prevent body scroll when popup is open
            document.body.style.overflow = popup.classList.contains('open') ? 'hidden' : 'auto';
        }

        function closeProfilePopup() {
            const popup = document.getElementById('userProfilePopup');
            const overlay = document.getElementById('popupOverlay');
            
            popup.classList.remove('open');
            overlay.classList.remove('open');
            document.body.style.overflow = 'auto';
        }

        // Profile Action Functions
        function editProfile() {
            alert('Edit Profile functionality will be implemented here');
            closeProfilePopup();
        }

        function viewOrders() {
            alert('Order History functionality will be implemented here');
            closeProfilePopup();
        }

        function viewFavorites() {
            alert('Favorites functionality will be implemented here');
            closeProfilePopup();
        }

        function settings() {
            alert('Settings functionality will be implemented here');
            closeProfilePopup();
        }

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                // Clear any stored data
                localStorage.removeItem('cart');
                localStorage.removeItem('selectedFoodType');
                localStorage.removeItem('selectedVendor');
                localStorage.removeItem('isLoggedIn');
                localStorage.removeItem('userPhone');
                
                // Redirect to login page
                window.location.href = 'login.html';
            }
        }

        // Close popup when pressing Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeProfilePopup();
            }
        });

        // Load user data (in a real app, this would come from backend)
        function loadUserData() {
            // Simulate loading user data
            const userData = {
                name: 'Foodie',
                type: 'Premium Buyer',
                location: 'Mumbai, Maharashtra',
                orders: 12,
                spent: '‚Çπ8,450',
                rating: 4.8,
                Sellers: 15
            };
            
            // Update profile info
            document.querySelector('.profile-info h3').textContent = `Welcome, ${userData.name}!`;
        }

        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        let selectedDelivery = 'standard';
        let selectedPayment = 'cod';

        function renderOrderItems() {
            const orderItemsContainer = document.getElementById('orderItems');
            
            orderItemsContainer.innerHTML = cart.map(item => `
                <div class="order-item">
                    <div class="item-info">
                        <div class="item-image">${item.image}</div>
                        <div class="item-details">
                            <h4>${item.name}</h4>
                            <p>Qty: ${item.quantity} √ó ‚Çπ${item.price}</p>
                        </div>
                    </div>
                    <div class="item-total">‚Çπ${item.price * item.quantity}</div>
                </div>
            `).join('');
        }

        function updateSummary() {
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const deliveryFee = selectedDelivery === 'express' ? 100 : 50;
            const discount = subtotal >= 500 ? 50 : 0;
            const total = subtotal + deliveryFee - discount;
            
            document.getElementById('subtotal').textContent = `‚Çπ${subtotal}`;
            document.getElementById('deliveryFee').textContent = `‚Çπ${deliveryFee}`;
            document.getElementById('discount').textContent = `-‚Çπ${discount}`;
            document.getElementById('total').textContent = `‚Çπ${total}`;
        }

        function selectDelivery(type) {
            selectedDelivery = type;
            
            // Update UI
            document.querySelectorAll('.delivery-option').forEach(option => {
                option.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
            
            updateSummary();
        }

        function selectPayment(type) {
            selectedPayment = type;
            
            // Update UI
            document.querySelectorAll('.payment-method').forEach(method => {
                method.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
        }

        function validateForm() {
            const requiredFields = document.querySelectorAll('input[required], select[required], textarea[required]');
            let isValid = true;
            
            requiredFields.forEach(field => {
                if (!field.value.trim()) {
                    field.style.borderColor = '#dc3545';
                    isValid = false;
                } else {
                    field.style.borderColor = '#ddd';
                }
            });
            
            return isValid;
        }

        function placeOrder() {
            if (!validateForm()) {
                alert('Please fill in all required fields');
                return;
            }
            
            if (cart.length === 0) {
                alert('Your cart is empty!');
                return;
            }
            
            // Collect form data
            const formData = {
                delivery: selectedDelivery,
                payment: selectedPayment,
                items: cart,
                total: document.getElementById('total').textContent,
                timestamp: new Date().toISOString()
            };
            
            // Store order in localStorage (in a real app, this would go to backend)
            localStorage.setItem('currentOrder', JSON.stringify(formData));
            
            // Clear cart
            localStorage.removeItem('cart');
            
            // Show success message
            showOrderSuccess();
        }

        function showOrderSuccess() {
            const checkoutForm = document.getElementById('checkoutForm');
            checkoutForm.innerHTML = `
                <div class="success-message">
                    <div class="success-icon">‚úÖ</div>
                    <h3>Order Placed Successfully!</h3>
                    <p>Your order has been confirmed and will be delivered soon.</p>
                    <p><strong>Order ID:</strong> #${Math.random().toString(36).substr(2, 9).toUpperCase()}</p>
                    <p><strong>Estimated Delivery:</strong> ${selectedDelivery === 'express' ? '1-2 hours' : '2-4 hours'}</p>
                    <div style="margin-top: var(--space-lg);">
                        <button class="btn" onclick="goToDashboard()">Go to Dashboard</button>
                    </div>
                </div>
            `;
        }

        function goBack() {
            window.location.href = 'cart.html';
        }

        function goToDashboard() {
            window.location.href = 'buyerDashboard.html';
        }

        // Initialize checkout
        document.addEventListener('DOMContentLoaded', function() {
            if (cart.length === 0) {
                alert('Your cart is empty! Redirecting to products page.');
                window.location.href = 'products.html';
                return;
            }
            
            renderOrderItems();
            updateSummary();
            setActiveNavLink();
            
            // Set default selections
            document.querySelector('.delivery-option').classList.add('selected');
            document.querySelector('.payment-method').classList.add('selected');
        });

        // Set active navigation link
        function setActiveNavLink() {
            const currentPage = window.location.pathname.split('/').pop() || 'checkout.html';
            const navLinks = document.querySelectorAll('.nav-links a');
            
            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === currentPage) {
                    link.classList.add('active');
                }
            });
        }
    </script>
</body>
</html> 